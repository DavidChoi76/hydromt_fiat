from hydromt_fiat.api.data_types import VulnerabilityIni
from hydromt import DataCatalog
import logging

from .data_types import Units


class VulnerabilityViewModel:
    def __init__(self, data_catalog: DataCatalog, logger: logging.Logger):
        self.vulnerability_model = VulnerabilityIni(
            vulnerability_fn="", link_table="", units=Units.m.value
        )
        self.data_catalog: DataCatalog = data_catalog
        self.logger: logging.Logger = logger

    def get_hazus_curves(self, hazus_fn: str):
        self.logger.info("Getting Hazus curves")
        df_vulnerability = self.data_catalog.get_dataframe("hazus_vulnerability_curves")
        return df_vulnerability
