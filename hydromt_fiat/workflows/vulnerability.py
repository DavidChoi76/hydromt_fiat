import pandas as pd
from pathlib import Path

### TO BE UPDATED ###
class Vulnerability:
    def __init__(self, datadir):
        self.datadir = datadir

    def get_vulnerability_function(self):
        # TODO: @Luis: this function needs to be changed. Now it looks up a damage function
        # according to country that is chosen but we want the user to choose their
        # damage functions per category (res, com, etc.). So our function will be
        # quite different.
        """Return the susceptibility function id and the maximum damage number."""

        # Read the global exposure configuration.
        df_config = pd.read_csv(
            Path(self.datadir).joinpath("vulnerability_test_file_input.csv")
        )

        # Get water depth values.
        wd_values = df_config['water depth']

        # Get the vulnerability factors.
        vf_values = df_config['vulnerability factor']
        
        # Combine the two arrays into a dataframe.
        v_dataframe = pd.DataFrame({'wd[ms]': wd_values, 'factor': vf_values})
        
        # Export the dataframe to a csv.
        v_dataframe.to_csv('vulnerability_test_file_output.csv', index=False)
        