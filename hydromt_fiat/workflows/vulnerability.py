import pandas as pd
from pathlib import Path

### TO BE UPDATED ###
class Vulnerability:
    def __init__(
        self
    ):
        
    def get_susceptibility_function(self):
        """Return the susceptibility function id and the maximum damage number."""

        # Read the global exposure configuration.
        df_config = pd.read_excel(
            Path("C:/Users/rodrigue/OneDrive - Stichting Deltares/Desktop/Other Projects/2023_01 FIAT Model Builder/Test data/Vulnerability/Global Configuration/global_configuration.xlsx"),
            sheet_name="Buildings",
        )

        # Get the function id.
        sf_id = df_config.loc[
            df_config["Alpha-3"] == self.config["country"],
            f"Damage_Function_ID_{self.config['hazard_type'].capitalize()}",
        ].values[0]

        # Get the maximum damage value.
        max_damage = df_config.loc[
            df_config["Alpha-3"] == self.config["country"],
            f"Max_Damage_{self.config['hazard_type']. capitalize()}",
        ].values[0]

        return sf_id, max_damage

print(Vulnerability)

my_vulnerability = Vulnerability()

my_vulnerability.get_susceptibility_function()
